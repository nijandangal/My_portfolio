<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="IoT Workshop - ESP32 LED Control Project. Learn hands-on IoT development with microcontrollers">
  <meta name="keywords" content="ESP32, IoT, LED, microcontroller, workshop, tutorial">
  <meta name="author" content="Nijan Dangal">
  <title>Nijan Dangal ‚Äî IoT Workshop</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Courier+Prime:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
  <nav class="navbar">
    <div class="nav-container">
      <div class="nav-logo">
        <i class="fas fa-microchip"></i> Nijan
      </div>
      <ul class="nav-menu" id="navMenu">
        <li><a href="index.html" class="nav-link">Home</a></li>
        <li><a href="portfolio.html" class="nav-link">Portfolio</a></li>
        <li><a href="workshop.html" class="nav-link active">Workshop</a></li>
        <li><a href="newsletter.html" class="nav-link">Newsletter</a></li>
        <li><a href="about.html" class="nav-link">About</a></li>
        <li><a href="contact.html" class="nav-link">Contact</a></li>
      </ul>
      <div class="hamburger" id="hamburger">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </nav>

  <!-- Header -->
  <section class="page-header">
    <h1>IoT Workshop</h1>
    <p>Learn to build smart IoT projects with ESP32</p>
  </section>

  <!-- Workshop Container with Sidebar -->
  <div class="workshop-container">
    <!-- Sidebar -->
    <aside class="workshop-sidebar">
      <div class="sidebar-title">Projects</div>
      <ul class="project-list">
        <li>
          <div class="project-link active" data-project="project-1">
            <span class="project-number">1</span>
            <span>Website Controlled LED (Web Server Mode)</span>
          </div>
        </li>
        <li>
          <div class="project-link" data-project="project-2">
            <span class="project-number">2</span>
            <span>Website Controlled LED (Web Client Mode)</span>
          </div>
        </li>
        <li>
          <div class="project-link" data-project="project-3">
            <span class="project-number">3</span>
            <span>Sample Project 3</span>
          </div>
        </li>
        <li>
          <div class="project-link" data-project="project-4">
            <span class="project-number">4</span>
            <span>Sample Project 4</span>
          </div>
        </li>
      </ul>
    </aside>

    <!-- Main Workshop Content -->
    <div class="workshop-main">
      <!-- Project 1 -->
      <div id="project-1" class="project-content active">
        <!-- Project Overview -->
        <section class="workshop-section">
          <div class="workshop-intro">
            <h2>Project 1: Website Controlled LED (Web Server Mode)</h2>
            <p class="intro-text">The ESP32 runs its own web server and hosts a control dashboard. Access it locally on your network using the ESP32's IP address. This is the <strong>simplest setup</strong> - perfect for beginners learning IoT. Control the built-in LED directly from your browser.</p>
            
            <div class="project-highlights">
              <div class="highlight">
                <i class="fas fa-server"></i>
                <h4>Local Web Server</h4>
                <p>ESP32 hosts its own dashboard - no external server needed</p>
              </div>
              <div class="highlight">
                <i class="fas fa-code"></i>
                <h4>Beginner Friendly</h4>
                <p>Simple code - just copy, change WiFi, and flash</p>
              </div>
              <div class="highlight">
                <i class="fas fa-magic"></i>
                <h4>One Default LED</h4>
                <p>Uses GPIO 2 built-in LED - no wiring required</p>
              </div>
              <div class="highlight">
                <i class="fas fa-mobile-alt"></i>
                <h4>Mobile Friendly</h4>
                <p>Access from phone/tablet on same WiFi network</p>
              </div>
            </div>
          </div>
        </section>

  <!-- Requirements Section -->
  <section class="workshop-section workshop-content">
    <h2>What You'll Need</h2>
    
    <div class="tabs">
      <button class="tab-btn active" data-tab="hardware">Hardware</button>
      <button class="tab-btn" data-tab="software">Software</button>
      <button class="tab-btn" data-tab="optional">Optional</button>
    </div>

    <div class="tab-content">
      <div id="hardware" class="tab-pane active">
        <div class="requirements-grid">
          <div class="requirement-card">
            <i class="fas fa-microchip"></i>
            <h4>ESP32 Development Board</h4>
            <p><strong>Required.</strong> ESP32 Dev Kit C or Wemos D1 R32. Has built-in LED on GPIO 2 and boot button on GPIO 0.</p>
          </div>
          <div class="requirement-card">
            <i class="fas fa-cable"></i>
            <h4>USB Cable (Micro/Type-C)</h4>
            <p><strong>Required.</strong> For programming and powering the ESP32. Most modern ESP32 boards use Micro-USB or USB Type-C.</p>
          </div>
          <div class="requirement-card">
            <i class="fas fa-circle"></i>
            <h4>Resistor 220Œ© (Optional)</h4>
            <p>Only needed if connecting external LED. Protects the LED from excessive current. Common value: 220Œ© or 330Œ©.</p>
          </div>
          <div class="requirement-card">
            <i class="fas fa-lightbulb"></i>
            <h4>External LED (Optional)</h4>
            <p>Standard 5mm LED for additional testing. Built-in LED on GPIO 2 works perfectly for the initial setup.</p>
          </div>
          <div class="requirement-card">
            <i class="fas fa-plug"></i>
            <h4>Breadboard & Jumper Wires (Optional)</h4>
            <p>For connecting external LED. Not needed for built-in LED testing - straight from USB power!</p>
          </div>
          <div class="requirement-card">
            <i class="fas fa-wifi"></i>
            <h4>WiFi Network</h4>
            <p><strong>Required.</strong> 2.4GHz WiFi for the ESP32 to connect. (ESP32 does not support 5GHz)</p>
          </div>
        </div>
      </div>

      <div id="software" class="tab-pane">
        <div class="requirements-grid">
          <div class="requirement-card">
            <i class="fab fa-windows"></i>
            <h4>Arduino IDE 2.0+</h4>
            <p><strong>Required.</strong> Free IDE for programming ESP32. Download from arduino.cc. Works on Windows/Mac/Linux.</p>
            <a href="https://www.arduino.cc/en/software" target="_blank" class="requirement-link">Download ‚Üí</a>
          </div>
          <div class="requirement-card">
            <i class="fab fa-github"></i>
            <h4>ESP32 Board Support</h4>
            <p><strong>Required.</strong> Install via Arduino Board Manager. Easiest way to get started (see Configuration Guide in Firmware Code section).</p>
          </div>
          <div class="requirement-card">
            <i class="fab fa-html5"></i>
            <h4>JSON Library (ArduinoJson)</h4>
            <p><strong>Recommended.</strong> For handling JSON responses. Install via Arduino Library Manager (search "ArduinoJson").</p>
          </div>
          <div class="requirement-card">
            <i class="fab fa-chrome"></i>
            <h4>Web Browser</h4>
            <p><strong>Required.</strong> Any modern browser (Chrome, Firefox, Edge, Safari) to access the control dashboard.</p>
          </div>
        </div>
      </div>

      <div id="optional" class="tab-pane">
        <div class="requirements-grid">
          <div class="requirement-card">
            <i class="fas fa-wrench"></i>
            <h4>USB Driver (CH340)</h4>
            <p>If your ESP32 board uses CH340 chip and is not recognized on Windows, install the driver manually.</p>
            <a href="http://www.wch.cn/product/ch340.html" target="_blank" class="requirement-link">Download Driver ‚Üí</a>
          </div>
          <div class="requirement-card">
            <i class="fas fa-cut"></i>
            <h4>Wire Stripper / Multimeter</h4>
            <p>Optional: For testing external LED connections and measuring voltage. Makes debugging easier.</p>
          </div>
          <div class="requirement-card">
            <i class="fas fa-book"></i>
            <h4>ESP32 Datasheet</h4>
            <p>Reference documentation. ESP32 pinouts and specifications for advanced projects. Download from Espressif.</p>
          </div>
          <div class="requirement-card">
            <i class="fas fa-mobile-alt"></i>
            <h4>Smartphone (Optional)</h4>
            <p>Access the LED control dashboard from your phone. Works on same WiFi network as ESP32.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Pin Configuration Section -->
  <section class="workshop-section">
    <h2>Pin Configuration (Default - No Modifications Needed)</h2>
    <div class="circuit-diagram">
      <div class="diagram-container">
        <div class="diagram-box">
          <h4>Default ESP32 Pin Assignment</h4>
          <table class="pin-table">
            <tr>
              <th>Component</th>
              <th>ESP32 GPIO Pin</th>
              <th>Hardware Type</th>
              <th>Function</th>
            </tr>
            <tr>
              <td><strong>Built-in LED</strong></td>
              <td><strong>GPIO 2</strong> (Blue LED)</td>
              <td>ESP32 Dev Kit C / Wemos D1</td>
              <td>Digital Output - Control via Website</td>
            </tr>
            <tr>
              <td><strong>Boot Button</strong></td>
              <td><strong>GPIO 0</strong></td>
              <td>ESP32 Dev Kit C / Wemos D1</td>
              <td>Manual Control - Physical Button</td>
            </tr>
            <tr>
              <td>External LED (Red)</td>
              <td>GPIO 4</td>
              <td>Optional External</td>
              <td>Additional Control</td>
            </tr>
            <tr>
              <td>Ground</td>
              <td>GND</td>
              <td>All Models</td>
              <td>Common Ground</td>
            </tr>
            <tr>
              <td>Power</td>
              <td>5V / 3.3V</td>
              <td>All Models</td>
              <td>Power Supply</td>
            </tr>
          </table>
          <div style="margin-top: 15px; padding: 12px; background: rgba(255, 193, 7, 0.1); border-radius: 8px; font-size: 13px; color: #666;">
            <strong>‚úì Quick Setup:</strong> This code uses the ESP32's built-in LED on GPIO 2 and boot button on GPIO 0. No external components needed for basic testing!
          </div>
        </div>
      </div>
      <div class="wiring-info">
        <h4>Wiring for External LED (Optional)</h4>
        <ol>
          <li><strong>GPIO 4</strong> ‚Üí <strong>220Œ© Resistor</strong> ‚Üí <strong>LED Positive (Long Leg)</strong></li>
          <li><strong>LED Negative (Short Leg)</strong> ‚Üí <strong>GND</strong></li>
          <li>Verify connections before powering (LEDs are polarity-sensitive)</li>
          <li>The code works with or without external LEDs connected</li>
        </ol>
        <h4 style="margin-top: 25px;">Supported ESP32 Models</h4>
        <ul style="margin-left: 20px; line-height: 1.8;">
          <li><strong>ESP32 Dev Kit C/V4</strong> (Official)</li>
          <li><strong>Wemos D1 R32</strong></li>
          <li><strong>ESP32-WROVER</strong></li>
          <li>Any ESP32 with GPIO 2 and GPIO 0 pins</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- ESP32 Firmware Code Section -->
  <section class="workshop-section">
    <h2>Project 1: ESP32 Firmware (Simple Start)</h2>
    <p style="color: #666; margin-bottom: 20px;"><strong>‚úì Simple Code:</strong> Only ~100 lines. Controls built-in LED (GPIO 2). Just update WiFi and flash!</p>
    <div class="code-container">
      <div class="code-tabs">
        <button class="code-tab-btn active" data-code="esp-simple">Simple ESP32 Code</button>
        <button class="code-tab-btn" data-code="esp-setup">Setup in 5 Steps</button>
      </div>

      <div class="code-content">
        <div id="esp-simple" class="code-pane active">
          <pre><code class="language-cpp">#include &lt;WiFi.h&gt;
#include &lt;WebServer.h&gt;

// ===== CHANGE THESE =====
const char* ssid = "YOUR_SSID";
const char* password = "YOUR_PASSWORD";
// ========================

#define LED_PIN 2  // Built-in LED on GPIO 2

WebServer server(80);
bool ledState = false;
bool blinkEnabled = false;
unsigned long blinkInterval = 500; // milliseconds
unsigned long lastToggle = 0;

void setup() {
  Serial.begin(115200);
  delay(1000);

  pinMode(LED_PIN, OUTPUT);
  digitalWrite(LED_PIN, LOW);

  Serial.println("Connecting to WiFi: " + String(ssid));
  WiFi.begin(ssid, password);

  int attempts = 0;
  while (WiFi.status() != WL_CONNECTED && attempts < 40) {
    delay(500);
    Serial.print(".");
    attempts++;
  }

  if (WiFi.status() == WL_CONNECTED) {
    Serial.println("\nWiFi Connected!");
    Serial.println("IP: http://" + WiFi.localIP().toString());

    // Setup web routes
    server.on("/", handleRoot);
    server.on("/on", handleOn);
    server.on("/off", handleOff);
    server.on("/toggle", handleToggle);
    server.on("/blink", handleBlink);
    server.on("/status", handleStatus);
    server.begin();
  } else {
    Serial.println("\nWiFi failed to connect");
  }
}

void loop() {
  server.handleClient();

  // Non-blocking blinking controlled by millis()
  if (blinkEnabled) {
    unsigned long now = millis();
    if (now - lastToggle >= blinkInterval) {
      ledState = !ledState;
      digitalWrite(LED_PIN, ledState ? HIGH : LOW);
      lastToggle = now;
    }
  }
}

// Handle root page - portfolio-themed HTML dashboard
void handleRoot() {
  const char* html = R"RAWHTML(<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Portfolio ‚Äî ESP32 LED Control</title>
  <style>
    body{font-family:Arial,Helvetica,sans-serif;background:#f3f4f6;margin:0;padding:20px}
    .card{max-width:640px;margin:20px auto;background:#fff;border-radius:12px;padding:20px;box-shadow:0 8px 30px rgba(2,6,23,0.06)}
    .header{display:flex;justify-content:space-between;align-items:center}
    h1{font-size:20px;margin:0;color:#111}
    p.lead{color:#555;margin:8px 0}
    .controls{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    button{padding:10px 14px;border:0;border-radius:8px;background:#667eea;color:#fff;cursor:pointer}
    .muted{background:#e5e7eb;color:#111}
    .section{margin-top:16px}
    label{display:block;margin-bottom:6px;color:#333}
    input[type=range]{width:100%}
    .status-box{margin-top:12px;padding:10px;background:#f8fafc;border-radius:6px;color:#111}
  </style>
</head>
<body>
  <div class="card">
    <div class="header">
      <h1>ESP32 ‚Äî LED Control (Portfolio)</h1>
      <small>Project 1</small>
    </div>
    <p class="lead">Control the built-in LED (GPIO 2). Use steady ON/OFF or enable blinking with adjustable speed. This lightweight dashboard is served directly from your ESP32 and is optimized for low CPU usage.</p>

    <div class="section">
      <div class="controls">
        <button onclick="fetch('/on')">ON</button>
        <button onclick="fetch('/off')">OFF</button>
        <button onclick="fetch('/toggle')">Toggle</button>
      </div>
    </div>

    <div class="section">
      <label for="speed">Blink speed (ms): <span id="speedVal">500</span></label>
      <input id="speed" type="range" min="100" max="2000" step="10" value="500" oninput="document.getElementById('speedVal').textContent=this.value">
      <div class="controls" style="margin-top:10px">
        <button onclick="startBlink()">Start Blink</button>
        <button class="muted" onclick="stopBlink()">Stop Blink</button>
      </div>
    </div>

    <div class="section status-box" id="status">Loading status...</div>
  </div>

  <script>
    async function updateStatus(){
      try{
        const r = await fetch('/status');
        const d = await r.json();
        document.getElementById('status').textContent = 'LED: ' + (d.state? 'ON':'OFF') + ' ‚Äî Blink: ' + (d.blink? 'ON':'OFF') + ' ‚Äî Speed: ' + (d.speed || '-') + ' ms';
      }catch(e){ document.getElementById('status').textContent = 'Status unavailable'; }
    }
    function startBlink(){
      const speed = document.getElementById('speed').value;
      fetch('/blink?action=start&speed='+speed).then(()=>updateStatus());
    }
    function stopBlink(){
      fetch('/blink?action=stop').then(()=>updateStatus());
    }
    updateStatus();
    // Poll less frequently to reduce load on ESP32
    setInterval(updateStatus,5000);
  </script>
</body>
</html>)RAWHTML";

  server.send(200, "text/html", html);
}

void handleOn() {
  blinkEnabled = false;
  digitalWrite(LED_PIN, HIGH);
  ledState = true;
  server.send(200, "application/json", "{\"success\":true,\"state\":1}");
}

void handleOff() {
  blinkEnabled = false;
  digitalWrite(LED_PIN, LOW);
  ledState = false;
  server.send(200, "application/json", "{\"success\":true,\"state\":0}");
}

void handleToggle() {
  blinkEnabled = false;
  ledState = !ledState;
  digitalWrite(LED_PIN, ledState ? HIGH : LOW);
  server.send(200, "application/json", String("{\"success\":true,\"state\":") + (ledState?"1":"0") + "}");
}

void handleBlink() {
  String action = server.arg("action");
  String speedStr = server.arg("speed");
  if (action == "start") {
    if (speedStr.length() > 0) {
      long s = speedStr.toInt();
      blinkInterval = (s < 100) ? 100UL : (unsigned long)s;
    }
    blinkEnabled = true;
    server.send(200, "application/json", String("{\"success\":true,\"blink\":true,\"speed\":") + String(blinkInterval) + "}");
  } else if (action == "stop") {
    blinkEnabled = false;
    server.send(200, "application/json", "{\"success\":true,\"blink\":false}");
  } else if (action == "set") {
    if (speedStr.length() > 0) {
      long s = speedStr.toInt();
      blinkInterval = (s < 100) ? 100UL : (unsigned long)s;
    }
    server.send(200, "application/json", String("{\"success\":true,\"speed\":") + String(blinkInterval) + "}");
  } else {
    server.send(400, "application/json", "{\"success\":false,\"error\":\"invalid action\"}");
  }
}

void handleStatus() {
  int state = digitalRead(LED_PIN);
  String json = String("{\"state\":") + String(state?1:0) + String(",\"ip\":\"") + WiFi.localIP().toString() + String("\",\"blink\":") + String(blinkEnabled?1:0) + String(",\"speed\":") + String(blinkInterval) + String("}");
  server.send(200, "application/json", json);
}</code></pre>
        </div>

        <div id="esp-setup" class="code-pane">
          <h4 style="color: #333; margin-bottom: 15px;">üìã Setup in 5 Simple Steps</h4>
          <div style="background: #f5f5f5; padding: 20px; border-radius: 8px; font-size: 14px; line-height: 1.8; color: #333;">
            
            <div style="background: white; padding: 15px; border-radius: 5px; margin-bottom: 15px; border-left: 4px solid #667eea;">
              <strong>Step 1: Install Arduino IDE</strong><br/>
              Download from arduino.cc and install on your computer.
            </div>
            
            <div style="background: white; padding: 15px; border-radius: 5px; margin-bottom: 15px; border-left: 4px solid #667eea;">
              <strong>Step 2: Add ESP32 Support</strong><br/>
              ‚Ä¢ File ‚Üí Preferences<br/>
              ‚Ä¢ Add this URL in "Additional Boards Manager URLs":<br/>
              <code style="background: #eee; padding: 5px;">https://dl.espressif.com/dl/package_esp32_index.json</code><br/>
              ‚Ä¢ Tools ‚Üí Board ‚Üí Boards Manager ‚Üí Search "ESP32" ‚Üí Install
            </div>
            
            <div style="background: white; padding: 15px; border-radius: 5px; margin-bottom: 15px; border-left: 4px solid #667eea;">
              <strong>Step 3: Copy This Code</strong><br/>
              Copy the code from left tab. Create new sketch (Ctrl+N) and paste it.
            </div>
            
            <div style="background: white; padding: 15px; border-radius: 5px; margin-bottom: 15px; border-left: 4px solid #667eea;">
              <strong>Step 4: Update WiFi</strong><br/>
              Find line 4-5 and change:<br/>
              <code style="background: #eee; padding: 5px; display: block; margin-top: 5px;">const char* ssid = "YOUR_SSID";<br/>const char* password = "YOUR_PASSWORD";</code><br/>
              Replace with your actual WiFi name and password.
            </div>
            
            <div style="background: white; padding: 15px; border-radius: 5px; border-left: 4px solid #667eea;">
              <strong>Step 5: Upload & Open</strong><br/>
              ‚Ä¢ Connect ESP32 with USB cable<br/>
              ‚Ä¢ Tools ‚Üí Board ‚Üí "ESP32 Dev Module"<br/>
              ‚Ä¢ Tools ‚Üí Port ‚Üí Select COM port<br/>
              ‚Ä¢ Click Upload button<br/>
              ‚Ä¢ Check Serial Monitor (Baud 115200) for IP address<br/>
              ‚Ä¢ Open IP in browser (e.g., http://192.168.1.100)
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Project 2: Web Client Mode -->
  <section class="workshop-section">
    <h2>Project 2: Website Controlled LED (Web Client Mode)</h2>
    <p style="color: #666; margin-bottom: 20px;"><strong>Control your ESP32 from anywhere!</strong> Enter the ESP32's IP address and use the toggle switch to control the LED. See live status updates. Simple and effective.</p>
    <div class="code-container">
      <div class="code-tabs">
        <button class="code-tab-btn active" data-code="web-dashboard">Website Dashboard HTML</button>
        <button class="code-tab-btn" data-code="web-controller">JavaScript Controller</button>
        <button class="code-tab-btn" data-code="web-usage">How to Use</button>
      </div>

      <div class="code-content">
        <div id="web-dashboard" class="code-pane active">
          <pre><code class="language-html">&lt;!-- Remote ESP32 Control Dashboard --&gt;
&lt;!-- Add this to your website to control ESP32 from anywhere --&gt;

&lt;div class="esp32-dashboard"&gt;
  &lt;div class="dashboard-header"&gt;
    &lt;h2&gt;üîå ESP32 Control Panel&lt;/h2&gt;
    &lt;span class="status" id="status"&gt;‚óè Offline&lt;/span&gt;
  &lt;/div&gt;

  &lt;div class="dashboard-body"&gt;
    &lt;!-- Connect to ESP32 --&gt;
    &lt;div class="section"&gt;
      &lt;h3&gt;Connect Your ESP32&lt;/h3&gt;
      &lt;input 
        type="text" 
        id="ip" 
        placeholder="192.168.1.100"
      &gt;
      &lt;button onclick="connect()"&gt;Connect&lt;/button&gt;
    &lt;/div&gt;

    &lt;!-- Toggle Switch for LED --&gt;
    &lt;div class="section"&gt;
      &lt;h3&gt;Built-in LED&lt;/h3&gt;
      &lt;div class="toggle-container"&gt;
        &lt;label class="switch"&gt;
          &lt;input type="checkbox" id="ledSwitch" onchange="toggleLED()"&gt;
          &lt;span class="slider"&gt;&lt;/span&gt;
        &lt;/label&gt;
        &lt;span id="ledLabel"&gt;OFF&lt;/span&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;!-- Info Display --&gt;
    &lt;div class="info"&gt;
      IP: &lt;span id="infoIP"&gt;---&lt;/span&gt;&lt;br/&gt;
      Signal: &lt;span id="infoSignal"&gt;---&lt;/span&gt; dBm
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
        </div>

        <div id="web-controller" class="code-pane">
          <pre><code class="language-javascript">// Simple ESP32 Controller for Website
let device = null;
let updateTimer = null;

// Initialize device connection
async function connect() {
  const ip = document.getElementById('ip').value.trim();
  if (!ip) {
    alert('Please enter ESP32 IP address');
    return;
  }

  device = {
    ip: ip,
    url: `http://${ip}`
  };

  const isOnline = await checkStatus();
  if (isOnline) {
    document.getElementById('status').innerHTML = '‚óè Online';
    document.getElementById('status').style.color = '#10b981';
    updateStatus();
    // Update status every 2 seconds
    clearInterval(updateTimer);
    updateTimer = setInterval(updateStatus, 2000);
  } else {
    alert('Cannot connect to ESP32. Check IP address.');
    document.getElementById('status').innerHTML = '‚óè Offline';
    document.getElementById('status').style.color = '#ef4444';
  }
}

// Get current LED status
async function checkStatus() {
  try {
    const response = await fetch(`${device.url}/status`);
    const data = await response.json();
    return true;
  } catch (err) {
    return false;
  }
}

// Update display with current status
async function updateStatus() {
  if (!device) return;
  
  try {
    const response = await fetch(`${device.url}/status`);
    const data = await response.json();
    
    document.getElementById('ledSwitch').checked = data.state ? true : false;
    document.getElementById('ledLabel').textContent = data.state ? 'ON' : 'OFF';
    document.getElementById('infoIP').textContent = data.ip;
  } catch (err) {
    console.error('Status update failed:', err);
  }
}

// Toggle LED on/off
async function toggleLED() {
  if (!device) {
    alert('Connect to ESP32 first');
    return;
  }

  const isChecked = document.getElementById('ledSwitch').checked;
  const url = isChecked ? '/on' : '/off';

  try {
    const response = await fetch(`${device.url}${url}`);
    const data = await response.json();
    updateStatus();
  } catch (err) {
    console.error('Toggle failed:', err);
    alert('Failed to control LED');
  }
}</code></pre>
        </div>

        <div id="web-usage" class="code-pane">
          <h4 style="color: #333; margin-bottom: 15px;">üìñ How to Add to Your Website</h4>
          <div style="background: #f5f5f5; padding: 20px; border-radius: 8px; font-size: 14px; line-height: 1.8; color: #333;">
            
            <h5 style="color: #667eea; margin: 15px 0 10px 0;">Step 1: Add HTML</h5>
            <p>Copy the HTML code from "Website Dashboard HTML" tab and add to your page where you want the dashboard to appear.</p>
            
            <h5 style="color: #667eea; margin: 15px 0 10px 0;">Step 2: Add CSS Styling</h5>
            <p>Add this CSS to style the dashboard:</p>
            <pre style="background: white; padding: 10px; border-radius: 5px; overflow-x: auto; font-size: 12px; margin: 10px 0;"><code>.esp32-dashboard {
  max-width: 400px;
  background: white;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  overflow: hidden;
}
.dashboard-header {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.dashboard-header h2 { margin: 0; }
.status { font-weight: bold; }
.dashboard-body { padding: 25px; }
.section { margin-bottom: 25px; }
.section h3 { color: #333; margin-bottom: 12px; }
.section input {
  width: 100%;
  padding: 10px;
  border: 2px solid #ddd;
  border-radius: 6px;
  font-size: 14px;
  margin-bottom: 10px;
}
.section button {
  width: 100%;
  padding: 10px;
  background: #667eea;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
}
.section button:hover { background: #764ba2; }
.toggle-container {
  display: flex;
  align-items: center;
  gap: 15px;
}
.switch {
  position: relative;
  display: inline-block;
  width: 50px;
  height: 28px;
}
.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}
.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  transition: .3s;
  border-radius: 28px;
}
.slider:before {
  position: absolute;
  content: "";
  height: 22px;
  width: 22px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  transition: .3s;
  border-radius: 50%;
}
input:checked + .slider {
  background-color: #10b981;
}
input:checked + .slider:before {
  transform: translateX(21px);
}
#ledLabel { font-weight: 700; font-size: 16px; }
.info {
  background: #f0f0f0;
  padding: 12px;
  border-radius: 6px;
  font-size: 13px;
  color: #666;
}</code></pre>
            
            <h5 style="color: #667eea; margin: 15px 0 10px 0;">Step 3: Add JavaScript</h5>
            <p>Copy the code from "JavaScript Controller" tab and add to your page's &lt;script&gt; section.</p>
            
            <h5 style="color: #667eea; margin: 15px 0 10px 0;">Step 4: Test It!</h5>
            <p>1. Reload the page<br/>
            2. Enter your ESP32's IP address (from Serial Monitor)<br/>
            3. Click Connect<br/>
            4. Use the toggle switch to control the LED!</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Test Your Setup for Project 1 -->
  <section class="workshop-section led-control-section" id="project1-test">
    <h2>üß™ Test Your Setup</h2>
    <p style="color: #555; margin-bottom: 15px;">Your ESP32 is running and serving the dashboard! Use the buttons below to control the LED or open the dashboard directly:</p>
    <div style="display: flex; flex-wrap: wrap; gap: 12px; align-items: center;">
      <input 
        type="text" 
        id="esp32-ip-input" 
        placeholder="Enter ESP32 IP (e.g., 192.168.1.100)" 
        style="padding: 10px 15px; border: 2px solid #ddd; border-radius: 6px; font-size: 14px; flex: 1; min-width: 250px;"
      >
      <button class="led-control-btn project-1" onclick="testESP32Dashboard()">
        <i class="fas fa-globe"></i> Open Dashboard
      </button>
      <button class="led-control-btn project-1" onclick="testLEDOn()">
        <i class="fas fa-lightbulb"></i> Test LED ON
      </button>
      <button class="led-control-btn project-1" onclick="testLEDOff()">
        <i class="fas fa-moon"></i> Test LED OFF
      </button>
    </div>
    <div id="test-status" style="margin-top: 15px; padding: 12px; border-radius: 6px; background: #ecfef5; color: #047857; display: none;">
      <i class="fas fa-check-circle"></i> <span id="test-message"></span>
    </div>
  </section>
  <section class="workshop-section">
    <h2>Getting Started - Step by Step</h2>
    <div class="steps-container">
      <div class="step">
        <div class="step-number">1</div>
        <h3>Prepare Hardware</h3>
        <p>Get an ESP32 Dev Kit C, USB cable, and optionally an LED with 220Œ© resistor. No soldering needed for the built-in LED test!</p>
      </div>
      <div class="step">
        <div class="step-number">2</div>
        <h3>Install Arduino IDE</h3>
        <p>Download Arduino IDE from arduino.cc. This is where you'll write and upload code to the ESP32. Completely free!</p>
      </div>
      <div class="step">
        <div class="step-number">3</div>
        <h3>Add ESP32 Support</h3>
        <p>Follow the "Configuration Guide" tab in the Firmware Code section to add ESP32 board support to Arduino IDE (5 minutes).</p>
      </div>
      <div class="step">
        <div class="step-number">4</div>
        <h3>Get the Code Ready</h3>
        <p>Copy the ESP32 firmware code. Only change 2 lines: your WiFi name (SSID) and password. That's it!</p>
      </div>
      <div class="step">
        <div class="step-number">5</div>
        <h3>Upload to ESP32</h3>
        <p>Connect ESP32 via USB, select the COM port in Arduino IDE, and click Upload. The code flashes in ~30 seconds.</p>
      </div>
      <div class="step">
        <div class="step-number">6</div>
        <h3>Access the Dashboard</h3>
        <p>Check Serial Monitor (Tools ‚Üí Serial Monitor, Baud 115200) to get the IP address. Open it in your browser to access the LED control panel.</p>
      </div>
      <div class="step">
        <div class="step-number">7</div>
        <h3>Control from Website</h3>
        <p>Add the website integration JavaScript code to nijandangal.com.np to control the ESP32 LED from anywhere on the same network.</p>
      </div>
      <div class="step">
        <div class="step-number">8</div>
        <h3>Test All Features</h3>
        <p>Try the physical Boot Button (GPIO 0), the web interface, and the website controller. Everything uses default pins - no code changes!</p>
      </div>
    </div>
  </section>

  <!-- Tips Section -->
  <section class="workshop-section workshop-content">
    <h2>Troubleshooting & FAQs</h2>
    <div class="tips-grid">
      <div class="tip-card">
        <i class="fas fa-question-circle"></i>
        <h4>Built-in LED Not Lighting Up?</h4>
        <p>The blue LED on GPIO 2 is very dim - check in a dark room. If still not working, verify WiFi is connected via Serial Monitor. The LED pin may be in use if WiFi fails.</p>
      </div>
      <div class="tip-card">
        <i class="fas fa-wifi-slash"></i>
        <h4>WiFi Connection Fails</h4>
        <p>Check SSID and password are correct (case-sensitive). Ensure your WiFi is 2.4GHz only (ESP32 doesn't support 5GHz). Try restarting the WiFi router.</p>
      </div>
      <div class="tip-card">
        <i class="fas fa-code"></i>
        <h4>Upload/Compile Errors?</h4>
        <p>Make sure you installed ArduinoJson library. Select correct board ("ESP32 Dev Module") and correct COM port. Try clicking RESET button on ESP32 during upload.</p>
      </div>
      <div class="tip-card">
        <i class="fas fa-mobile-alt"></i>
        <h4>Can't Access IP Address</h4>
        <p>Get IP from Serial Monitor (Baud 115200). Use http:// not https://. Ensure your computer and ESP32 are on the same WiFi network.</p>
      </div>
      <div class="tip-card">
        <i class="fas fa-button"></i>
        <h4>Boot Button Not Working?</h4>
        <p>The Boot button on GPIO 0 is used to toggle the built-in LED. It's not the same as the RESET button. Press and hold briefly (200ms debounce).</p>
      </div>
      <div class="tip-card">
        <i class="fas fa-globe"></i>
        <h4>Website Widget Not Connecting?</h4>
        <p>Enter the correct ESP32 IP address. Check browser console for errors (F12). Verify both website and ESP32 are on same network. Enable CORS on ESP32.</p>
      </div>
      <div class="tip-card">
        <i class="fas fa-plug"></i>
        <h4>USB Cable Issues</h4>
        <p>Use a quality USB cable (not charge-only). Try different USB ports. Install CH340 driver if board is not recognized on Windows.</p>
      </div>
      <div class="tip-card">
        <i class="fas fa-clock"></i>
        <h4>Buttons Don't Respond Immediately</h4>
        <p>2-second refresh rate is normal. Click once and wait. Multiple rapid clicks are ignored by design to prevent flooding the ESP32.</p>
      </div>
    </div>
  </section>

  <!-- Interactive Demo -->
  <section class="workshop-section">
    <h2>Interactive LED Simulator</h2>
    <p style="text-align: center; margin-bottom: 20px; color: #666;">Try controlling simulated LEDs (click the circles to toggle)</p>
    <div class="led-simulator">
      <div class="led-circle red" id="simRed" onclick="toggleSimLED('red')">
        <div class="led-glow"></div>
      </div>
      <div class="led-circle green" id="simGreen" onclick="toggleSimLED('green')">
        <div class="led-glow"></div>
      </div>
      <div class="led-circle blue" id="simBlue" onclick="toggleSimLED('blue')">
        <div class="led-glow"></div>
      </div>
    </div>
  </section>
      </div>
      <!-- End Project 1 -->

      <!-- Project 2: content available above in the Web Client section -->
      <div id="project-2" class="project-content">
        <!-- Project 2 content is displayed earlier in the page (Web Client Mode). -->
      </div>
      <!-- End Project 2 -->

      <!-- Project 3 -->
      <div id="project-3" class="project-content">
        <section class="workshop-section">
          <div class="workshop-intro">
            <h2>Sample Project 3</h2>
            <p class="intro-text">Coming soon! Share your innovative IoT solutions here.</p>
          </div>
        </section>
      </div>
      <!-- End Project 3 -->

      <!-- Project 4 -->
      <div id="project-4" class="project-content">
        <section class="workshop-section">
          <div class="workshop-intro">
            <h2>Sample Project 4</h2>
            <p class="intro-text">Coming soon! Explore more advanced IoT applications.</p>
          </div>
        </section>
      </div>
      <!-- End Project 4 -->
    </div>
  </div>
  <!-- End Workshop Container -->

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-content">
      <div class="footer-section">
        <h4>Quick Links</h4>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="portfolio.html">Portfolio</a></li>
          <li><a href="workshop.html">Workshop</a></li>
          <li><a href="newsletter.html">Newsletter</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h4>Connect</h4>
        <div class="social-links">
          <a href="#" title="LinkedIn"><i class="fab fa-linkedin"></i></a>
          <a href="#" title="GitHub"><i class="fab fa-github"></i></a>
          <a href="#" title="Twitter"><i class="fab fa-twitter"></i></a>
          <a href="#" title="Email"><i class="fas fa-envelope"></i></a>
        </div>
      </div>
      <div class="footer-section">
        <h4>Contact</h4>
        <p>Email: nijandangal1993@gmail.com</p>
        <p>Phone: +977 98xxxxxxxx</p>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; 2026 Nijan Dangal. All rights reserved.</p>
    </div>
  </footer>

  <script src="script.js"></script>
</body>
</html>
